{"remainingRequest":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/src/components/search/lineChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/src/components/search/lineChart.vue","mtime":1630212097139},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/cnwangzd/Documents/cnwangzd/wecise/m3/apps/m3search/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7CmltcG9ydCBlY2hhcnRzIGZyb20gJ2VjaGFydHMnOwpleHBvcnQgZGVmYXVsdHsKICAgIHByb3BzOnsKICAgICAgICBtb2RlbDpPYmplY3QKICAgIH0sCiAgICBkYXRhKCl7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgY2hhcnQ6IG51bGwsCiAgICAgICAgICAgIG9wdGlvbjogewogICAgICAgICAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdheGlzJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRvb2xib3g6IHsKICAgICAgICAgICAgICAgICAgICByaWdodDogMTAsCiAgICAgICAgICAgICAgICAgICAgdG9wOiAwLAogICAgICAgICAgICAgICAgICAgIGZlYXR1cmU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVpvb206IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlBeGlzSW5kZXg6ICdub25lJwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICByZXN0b3JlOiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUFzSW1hZ2U6IHt9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGdyaWQ6IHsKICAgICAgICAgICAgICAgICAgICB0b3A6ICcxNSUnLAogICAgICAgICAgICAgICAgICAgIGxlZnQ6ICczJScsCiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6ICc0JScsCiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAnMzUlJywKICAgICAgICAgICAgICAgICAgICBjb250YWluTGFiZWw6IHRydWUKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB4QXhpczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogW10KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB5QXhpczogewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICd2YWx1ZScKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzZXJpZXM6IFtdCiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgfQogICAgfSwKICAgIHdhdGNoOiB7CiAgICAgICAgbW9kZWw6ewogICAgICAgICAgICBoYW5kbGVyKCl7CiAgICAgICAgICAgICAgICB0aGlzLmluaXREYXRhKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRlZXA6dHJ1ZQogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCl7CiAgICAgICAgCiAgICAgICAgLy8g5Yid5aeL5YyW5pWw5o2uCiAgICAgICAgdGhpcy5pbml0RGF0YSgpOwoKICAgICAgICAvLyDmjqXmlLbnqpfkvZNSRVNJWkXkuovku7YKICAgICAgICB0aGlzLmV2ZW50SHViLiRvbigiV0lORE9XLVJFU0laRS1FVkVOVCIsIHRoaXMuY2hlY2tDaGFydCk7CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLiRuZXh0VGljaygoKT0+ewogICAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgICB9KQoKICAgICAgICAvLyDnm5HlkKznqpflj6Plj5HnlJ/lj5jljJbvvIxyZXNpemXnu4Tku7YKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5jaGVja0NoYXJ0KQogICAgICAgIAogICAgICAgIC8vIOmAmui/h2hvb2vnm5HlkKznu4Tku7bplIDmr4HpkqnlrZDlh73mlbDvvIzlubblj5bmtojnm5HlkKzkuovku7YKICAgICAgICB0aGlzLiRvbmNlKCdob29rOmJlZm9yZURlc3Ryb3knLCAoKSA9PiB7CiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLmNoZWNrQ2hhcnQpCiAgICAgICAgfSkKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgaW5pdCgpewogICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57CiAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0ID0gZWNoYXJ0cy5pbml0KHRoaXMuJHJlZnMuY2hhcnRDb250YWluZXIpOwogICAgICAgICAgICAgICAgdGhpcy5jaGFydC5zZXRPcHRpb24odGhpcy5vcHRpb24pOwogICAgICAgICAgICB9LDUwMCkKICAgICAgICB9LAogICAgICAgIGluaXREYXRhKCl7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIGxldCBwYXJhbSA9IGVuY29kZVVSSUNvbXBvbmVudCggSlNPTi5zdHJpbmdpZnkodGhpcy5tb2RlbCkgKTsKICAgICAgICAgICAgICAgIHRoaXMubTMuY2FsbEZTKCIvbWF0cml4L20zc2VhcmNoL3NlYXJjaFBlcmZvcm1hbmNlQnlUZXJtLmpzIixwYXJhbSkudGhlbiggcmVzPT57CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYocmVzLm1lc3NhZ2UucmVzdWx0Lmxlbmd0aCA8IDEpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBsZXQgcnRuID0gcmVzLm1lc3NhZ2UucmVzdWx0LnJldmVyc2UoKTsKCiAgICAgICAgICAgICAgICAgICAgLy/lj5blrp7ml7bmlbDmja7nmoR0aW1l5L2c5Li6eEF4aXMKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbi54QXhpcy5kYXRhID0gXy5tYXAocnRuLCh2KT0+ewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb21lbnQodlswXSkuZm9ybWF0KCdZWS1NTS1ERCBISDptbScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uLnNlcmllcyA9IFt7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGAke3RoaXMubW9kZWwuYnVja2V0fSAke3RoaXMubW9kZWwua2V5fWAsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IF8ubWFwKHJ0biwodik9PnsgcmV0dXJuIHZbMV07fSksCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgICAgICAgICAgICAgc21vb3RoOnRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgxMDgsIDIxMiwgMTEsIDEpJywKICAgICAgICAgICAgICAgICAgICAgICAgYXJlYVN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogbmV3IGVjaGFydHMuZ3JhcGhpYy5MaW5lYXJHcmFkaWVudCgwLCAwLCAwLCAxLCBbewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiYSgxMDgsIDIxMiwgMTEsIC41KScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZ2JhKDEwOCwgMjEyLCAxMSwgLjEpJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuJHJlZnMuY2hhcnRDb250YWluZXIpewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0LnNldE9wdGlvbih0aGlzLm9wdGlvbik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSApOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0gY2F0Y2goZXJyKXsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgY2hlY2tDaGFydCgpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICB0aGlzLmNoYXJ0LnJlc2l6ZSgpOwogICAgICAgICAgICB9IGNhdGNoKGVycil7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycikKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGVzdHJveWVkKCl7CiAgICAgICAgICAgICQodGhpcy4kZWwpLm9mZigpOwogICAgICAgIH0KICAgIH0gICAgCn0K"},{"version":3,"sources":["lineChart.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"lineChart.vue","sourceRoot":"src/components/search","sourcesContent":["<template>\n    <div>\n        <h5>{{model.id}}/{{model.bucket}}/{{model.key}}</h5>\n        <div style=\"width:100%;height:300px;\" ref=\"chartContainer\"></div>\n    </div>\n</template>\n\n<script>\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport echarts from 'echarts';\nexport default{\n    props:{\n        model:Object\n    },\n    data(){\n        return {\n            chart: null,\n            option: {\n                tooltip: {\n                    trigger: 'axis'\n                },\n                toolbox: {\n                    right: 10,\n                    top: 0,\n                    feature: {\n                        dataZoom: {\n                            yAxisIndex: 'none'\n                        },\n                        restore: {},\n                        saveAsImage: {}\n                    }\n                },\n                grid: {\n                    top: '15%',\n                    left: '3%',\n                    right: '4%',\n                    bottom: '35%',\n                    containLabel: true\n                },\n                xAxis: {\n                    type: 'category',\n                    data: []\n                },\n                yAxis: {\n                    type: 'value'\n                },\n                series: []\n            }                            \n        }\n    },\n    watch: {\n        model:{\n            handler(){\n                this.initData();\n            },\n            deep:true\n        }\n    },\n    created(){\n        \n        // 初始化数据\n        this.initData();\n\n        // 接收窗体RESIZE事件\n        this.eventHub.$on(\"WINDOW-RESIZE-EVENT\", this.checkChart);\n    },\n    mounted() {\n        this.$nextTick(()=>{\n            this.init();\n        })\n\n        // 监听窗口发生变化，resize组件\n        window.addEventListener('resize', this.checkChart)\n        \n        // 通过hook监听组件销毁钩子函数，并取消监听事件\n        this.$once('hook:beforeDestroy', () => {\n            window.removeEventListener('resize', this.checkChart)\n        })\n    },\n    methods: {\n        init(){\n            setTimeout(()=>{\n                this.chart = echarts.init(this.$refs.chartContainer);\n                this.chart.setOption(this.option);\n            },500)\n        },\n        initData(){\n            try{\n                let param = encodeURIComponent( JSON.stringify(this.model) );\n                this.m3.callFS(\"/matrix/m3search/searchPerformanceByTerm.js\",param).then( res=>{\n                    \n                    if(res.message.result.length < 1) return false;\n                    \n                    let rtn = res.message.result.reverse();\n\n                    //取实时数据的time作为xAxis\n                    this.option.xAxis.data = _.map(rtn,(v)=>{\n                        return this.moment(v[0]).format('YY-MM-DD HH:mm');\n                    });\n                    \n                    this.option.series = [{\n                        name: `${this.model.bucket} ${this.model.key}`,\n                        data: _.map(rtn,(v)=>{ return v[1];}),\n                        type: 'line',\n                        smooth:true,\n                        color: 'rgba(108, 212, 11, 1)',\n                        areaStyle: {\n                            normal: {\n                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n                                    offset: 0,\n                                    color: 'rgba(108, 212, 11, .5)'\n                                }, {\n                                    offset: 1,\n                                    color: 'rgba(108, 212, 11, .1)'\n                                }])\n                            }\n                        }\n                    }];\n\n                    if(this.$refs.chartContainer){\n                        this.chart.setOption(this.option);\n                    }\n                } );\n                \n            } catch(err){\n                console.error(err);\n            }\n        },\n        checkChart(){\n            try{\n                this.chart.resize();\n            } catch(err){\n                console.error(err)\n            }\n        },\n        destroyed(){\n            $(this.$el).off();\n        }\n    }    \n}\n</script>\n\n<style scoped>\n    .container{\n        padding: 20px;\n        background: #f2f2f2;\n    }\n</style>\n"]}]}